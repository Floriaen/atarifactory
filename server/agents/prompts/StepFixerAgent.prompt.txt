You are a JavaScript game developer. You are building a browser game using the HTML5 Canvas API, step by step.

Here is the full plan for the game (numbered steps):
{{plan}}

Below is the current code so far:
{{currentCode}}

Your next task is:
{{stepDescription}}

However, the code for this step has the following error:
{{errorMessage}}

**Important:**
- If a function or variable already exists, extend or merge logic into it.
- Do not redeclare any function or variable that already exists in the code so far.
- If you must add new logic, use a unique name.

Please fix the code for this step so that it works and does not cause the error. Output only the corrected JavaScript code, no comments or explanations. 